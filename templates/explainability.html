{% extends "layout.html" %}

{% block main %}

    <main class="relative overflow-hidden bg-gradient-to-b from-gray-100 to-white pt-4">
        <div class="bg-white flex flex-col items-center w-full px-4 sm:px-6 lg:px-8 pb-6 pt-20">
            <div class="w-16 h-16 rounded-xl gradient-purple flex items-center justify-center mb-4">
                <svg viewBox="-7 -7 39.00 39.00" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                    <g id="SVGRepo_iconCarrier"> <path d="M19.0006 9.03002C19.0007 8.10058 18.8158 7.18037 18.4565 6.32317C18.0972 5.46598 17.5709 4.68895 16.9081 4.03734C16.2453 3.38574 15.4594 2.87265 14.5962 2.52801C13.7331 2.18336 12.8099 2.01409 11.8806 2.03002C10.0966 2.08307 8.39798 2.80604 7.12302 4.05504C5.84807 5.30405 5.0903 6.98746 5.00059 8.77001C4.95795 9.9595 5.21931 11.1402 5.75999 12.2006C6.30067 13.2609 7.10281 14.1659 8.09058 14.83C8.36897 15.011 8.59791 15.2584 8.75678 15.5499C8.91565 15.8415 8.99945 16.168 9.00059 16.5V18.03H15.0006V16.5C15.0006 16.1689 15.0829 15.843 15.24 15.5515C15.3971 15.26 15.6241 15.0121 15.9006 14.83C16.8528 14.1911 17.6336 13.328 18.1741 12.3167C18.7147 11.3054 18.9985 10.1767 19.0006 9.03002V9.03002Z"
                         stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> <path d="M15 21.04C14.1345 21.6891 13.0819 22.04 12 22.04C10.9181 22.04 9.86548 21.6891 9 21.04" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path> </g></svg>
            </div>
            <h2 class="text-3xl font-bold text-center tech-dark-purple mb-12">Model Explainability</h2>
            <p class="text-l md:text-l text-gray-600 max-w-3xl mx-auto mb-8 animate-fade-in" style="animation-delay: 0.2s;">
                This page helps you understand how your trained machine learning model makes decisions by visualizing feature importance and generating explanations.
                This is especially useful for building trust in your models and identifying potential biases or unexpected patterns.
                Upload a trained model and the corresponding dataset used to train it. The system will use techniques like SHAP to show which features influenced predictions the most.
            </p>
        </div>
        <form method="POST" enctype="multipart/form-data">
            <input type="file" name="dataset" required>
            <button type="submit" class="bg-purple-500 hover:bg-purple-600 text-white px-8 py-2 rounded-md font-medium">Analyze</button>
        </form>
    </main>

    {% if error %}
            <p style="color:red">{{ error }}</p>
    {% endif %}

    {% if stats %}
        <section>
            <h3>Descriptive Stats</h3>
            <table>
                <thead></thead>
                {% for col, values in stats.items() %}
                    <li><strong>{{ col }}</strong>: {{ values }}</li>
                {% endfor %}
            </table>
            <h3>Plots</h3>
            {% for plot in plots %}
                <img src="{{ plot }}" width="500">
            {% endfor %}

        </section>
    {% endif %}

{% endblock %}